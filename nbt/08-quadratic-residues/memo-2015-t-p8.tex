\documentclass[../08-quadratic-residues.tex]{subfiles}

\begin{document}

\begin{example*}[\gls{MEMO 2015}/T/P8]\label{example:MEMO-2015-T-P4}[\textbf{\nameref{definition:25M}}]
	Cho \( n \ge 2 \) là một số nguyên. Hỏi có bao nhiêu số nguyên dương \( m \le n \) sao cho \( m^2 + 1 \) chia hết cho \( n \)?	
\end{example*}

\begin{story*}
	Để giải bài toán, ta cần đếm số nghiệm của phương trình \( m^2 \equiv -1 \Mod{n} \). Điều này tương đương với việc xác định khi nào \( -1 \) là phần dư bậc hai modulo \( n \), và bao nhiêu nghiệm tồn tại. Ta xét các điều kiện để phương trình có nghiệm trên từng thừa số nguyên tố của \( n \), dùng tính chất của ký hiệu Legendre, và áp dụng định lý phần dư Trung Hoa để đưa ra công thức tổng quát cho số nghiệm.
\end{story*}

\bigbreak

\begin{soln}\footnotemark
	Gọi \( D(n) \) là số lượng \( m \le n \) sao cho \( n \mid m^2 + 1 \), hay \( m^2 \equiv -1 \pmod{n} \).  

	\textbf{Bước 1.} Nếu \( n \) chia hết cho một số nguyên tố \( \equiv 3 \pmod{4} \) hoặc \( 4 \mid n \), thì \( -1 \) không phải là bình phương modulo \( n \), nên \( D(n) = 0 \).  

	\textbf{Bước 2.} Với \( p \equiv 1 \pmod{4} \), ta có \( -1 \) là phần dư bậc hai modulo \( p \), nên \( x^2 \equiv -1 \pmod{p^k} \) có đúng hai nghiệm (theo nâng nghiệm Hensel). Vậy:
	\[
		D(p^k) = 2 \quad \text{nếu } p \equiv 1 \pmod{4}.
	\]

	\textbf{Bước 3.} Với \( n = p_1^{\alpha_1} p_2^{\alpha_2} \cdots p_k^{\alpha_k} \), các \( p_i \equiv 1 \pmod{4} \), thì theo định lý phần dư Trung Hoa:
	\[
		D(n) = D(p_1^{\alpha_1}) \cdots D(p_k^{\alpha_k}) = 2^k.
	\]

	\textbf{Bước 4.} Nếu \( n = 2 \cdot p_1^{\alpha_1} \cdots p_k^{\alpha_k} \), với các \( p_i \equiv 1 \pmod{4} \), thì vẫn có nghiệm vì \( x^2 \equiv -1 \pmod{2} \) có nghiệm \( x \equiv 1 \). Vậy:
	\[
		D(n) = 2^k.
	\]

	\textbf{Bước 5.} Nếu \( 4 \mid n \), thì không có nghiệm modulo 4, nên \( D(n) = 0 \).

	\textbf{Kết luận:} \( D(n) = 2^k \) khi và chỉ khi tất cả ước nguyên tố lẻ của \( n \) đều \( \equiv 1 \pmod{4} \), và \( 4 \nmid n \).  
	Ngược lại, \( D(n) = 0 \).
\end{soln}

\footnotetext{\href{http://memo2015.dmfa.si/files/solutions.pdf}{Lời giải chính thức.}}

\end{document}